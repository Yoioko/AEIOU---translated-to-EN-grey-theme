■After Effects Input/Output Utility 簡易説明 [2024-12-10 版]

◇基本説明
　本ツールは、シート内の"セル"以下の項目（以下、セル）に対して数値入力することにより、AfterEffects（以下、AE）の"TimeRemap"情報（以下、リマップ情報）の編集を行います。


◇変更点について

　（V3.1の主な変更点）
　・アンドゥ実装の変更（リドゥ動作を追加）
　・タイミングコピー時のバージョン文字列を iniファイルに記録する動作の追加（初めて v3.1を起動する時は、.iniファイルを削除して新しく作る必要あり）

　（V3.0の主な変更点）
　・V2.1.0.3ベースの機能実装を、C# & .NetFramework環境にて書き直し。
　・32bit⇒64bitコードに移行。
　・アンドゥ実装の追加。
　・初期設定ファイルの一元化。(⇒aeiou.ini)
　・大まかには同一の機能を持つが、新規実装のため挙動の違いは多数あり。


◇基本操作

・選択
　"矢印キー" 又は "マウス"により選択できます。
　※選択中のセルは、下地の色が違います。

・範囲指定
　Shiftキーを押しながら"矢印キー" 又は "マウス"選択により、範囲指定できます。
　※マウスの場合、開始位置のセルでマウスボタンを押し下げたまま終端位置までドラッグするだけでも指定できます。
　※(v3.0.0.0)Ctrlキー同時押しで選択しようとした場合には選択範囲を解除し、最後にクリックした場所のみ選択となります。

・移動
  選択範囲を掴み、ドラッグすることで選択範囲の移動ができます。
  ※選択元が暗く範囲表示され、移動範囲は通常の選択色で表示されます。

・コピー
  移動中にCtrlキーを押し続けることで、移動後の動作が "コピー動作"となります。
  ※選択元が暗く範囲表示され、コピー範囲は通常の選択色で表示されます。

・削除(1)
  範囲選択後、Deleteキーで内容を削除できます。
　※BSキーのようなセル移動はありません。

・削除(2)
  未記入セル上でBackSpace(BSキー)を押すと、１つ前のセルの内容を順次削除できます。
　※メモ帳のように、行ごと削除して前詰めをする動作はありません。単に対象セルの内容を削除します。

・全選択
　シートの左上角のマスをクリックすることで全選択できます。（全選択までの反応が遅いので、連続でクリックしないでください）
　※(v3.0.0.0)仕様変更。以前は『ダブルクリックすることで全選択』

・編集(1)
  選択中に数値入力(0-9)で数値を入力できます。
  入力中にBackSpace(BSキー)で、入力値の下１桁を削除します。
  ※新規入力時以外、入力中は１の位として順次桁追加による入力となります。新規入力時は、セルの値を上書きします。（BSキーを除く）
  ※範囲指定時は、範囲指定の複数セルに対して同時入力になります。（各セルの一番上の行が入力対象になります。）
  ※(v3.0.0.2)v0.03cの動作ルールに戻した。
  ※(v3.0.0.0)桁入力処理を改定。(常に桁追加入力によるものとした)
  ※(v0.03c  )桁入力処理を改定。(セル選択直後は新規入力／キー入力後は桁入力の切り替えを付加)
　※(v2.0.0.5)新規入力時、選択範囲を消去する動作を追加。

・編集(2)
　複数セルに跨った選択範囲を設定することで、並列で同じ内容を入力します。
　※(v2.0.0.7)新規追加。

・カラセルの入力
　"."で、カラセルを入力します。
　※後述のカラセル指定で、カラセルに対応するタイミング数値の設定変更が出来ます。

・改行(Enter/Returnキー)
  カーソルキーの"↓"のように、一段下にカーソルを移動します。
  ※複数行の範囲指定をしている状態では、移動範囲が選択幅単位になります。
　　２コマ打ち、３コマ打ち時に使います。
　※入力位置が、画面2/3以下になると画面送りします。

・カーソル移動（１）
　"Return"キーで、選択範囲を保ったまま、選択範囲分移動します。

・カーソル移動（２）
　カーソルキーの"↑↓"で、範囲選択の単位で移動します。
　Ctrlを押したままカーソルキーの"↑↓"で、選択範囲を保ったまま１マスずつ移動します。
　※(v2.0.0.7)キーバインド変更。

・自動入力（１）
　"+"で、１ずつ増やしながらセルを入力します。
　カーソル移動は、選択範囲を基準にします。
　たとえば、３コマ打ちで１～１０を入力する場合は、先頭フレームから３コマ選択した状態で、"+"キーを１０回押します。
　※中抜き範囲に入ってしまった場合は、自動的に範囲計算をします。

・自動入力（２）
　"-"で、１ずつ減らしながら入力します。
　※それ以外は、"+"と同じです。

・キーの頭出し
　"J" および "K"で、カーソル前後の入力済みのマスに飛びます。
　※(v2.0.0.6)廃止。単に隣のセルに移動する機能に変更。
　※(v2.0.0.7)キーバインド変更。
　※(v2.0.0.8)キーバインド変更。

・ページ送り（PageUp/Down）
　１秒分送ります。
　＋Ctrlで、１ページ分送ります。
　※表示幅が１秒に満たない場合は、送り幅を１／２にします。
　※(v3.0.0.0)仕様変更。表示幅が１秒に満たない場合の動作を削除。

・先頭に戻す
　HOMEキーで、先頭フレームに戻ります。

・選択範囲の拡大/縮小(1)
　"*"キーで範囲を広げます。（Shift+↓でも可）
　"/"キーで範囲を狭めます。（Shift+↑でも可）

・選択範囲の拡大/縮小(2)
　Shift+→で横方向の範囲を広げます。
　Shift+←で横方向の範囲を狭めます。

・"0"の入力
　"Space"キーで、"0"を入力します。
　※(v3.0.0.0)廃止。


◇基本機能

・ウィンドウ位置の保存
　AEIOU.EXEと同じフォルダに、aeiou.iniファイルを作成します。
　このファイルにウィンドウ位置＆サイズほか各種設定を保存します。
　※ウィンドウを見失った時は、ファイルをテキストエディタで開き該当項目を修正してください。
　※事前に編集済みの設定ファイルを取り置きしておき、問題が出た場合には上書きコピーするのも良いと思います。
　(v3.0.0.0)aeiou.dat他の初期設定ファイルを、aeiou.iniファイルに統一。

・AEへ コピー
　編集中のセル情報を、AEのリマップ情報としてコピーします。
  ※この操作実行後、AE側の"TimeRemap"項目に直接ペーストしてください。
  ※AEコピー＆ペーストは、編集中のセル全てが対象です。（範囲指定は関係ありません）

・AEへ コピー(TimeRemap以外)
　編集中のセル情報を、AEのリマップ情報としてコピーします。
  ※TimeRemap用の場合は『タイミング⇒秒数変換』を行いますが、
　　この機能は『タイミングの値』をそのままリマップ値として渡します。
　※TimeRemap以外の項目（例えば、エフェクトのパラメータ）に貼り付けたい場合に使います。
　　例）エフェクトパラメータに0～100%で値を設定する項目があり、
　　　　1コマ目に 0%, 1+12コマ目に 100%と入れたい場合
　　⇒1コマ目に"0", 1+12コマ目に"100"と入力して、AEへ コピー(TimeRemap以外)を選択した後で、
　　　AEの該当項目に貼り付け。

・AEへ コピー(Script仲介)
　別途『AEへコピー(Script仲介)_設定方法.txt』を参照してください。

・AEから ペースト
　AE側でコピーしたリマップ情報を、セルにペーストします。
  ※AE側の"TimeRemap"項目をコピー後、ペーストしてください。
  ※AEコピー＆ペーストは、編集中のセル（一列）が対象です。複数セルの一括コピーはできません。
　※また、行方向の選択範囲に関係なく一列すべてをコピー＆ペーストします。
　(v3.0.0.0)リマップ情報のエラーを表示させていたText編集エリアの廃止。

・元に戻す（アンドゥ）
　操作手順を１つ分戻します。
　戻した操作を再実行する機能（リドゥ）はありません。
　※"戻した操作"を元に戻すことはできません。
　※機能によって複数の操作手順を連続実行する為、アンドゥが複数回必要な場合があります。

・コピー
  範囲指定部分をコピー用として記憶します。

・カット
  範囲指定部分をカット用として記憶します。

・貼り付け
  コピー／カットで記憶した内容を、指定位置に貼り付けます。
　※事前操作がカットの場合は、カット時に指定した範囲の消去も同時に行われます。

・全て選択
  セル全てを選択範囲に含めます。
　※(v3.0.0.0)廃止。

・反転
　指定範囲の入力内容を、逆順に並べ替えます。

・繰り返し
　カーソル位置から、指定の入力に従い番号入力を実施。

　・開始～終了番号：　セルに入力する値の範囲
　・コマ打ち数　　：　何コマ打ちで入力するかを指定
　・繰り返し数　　：　開始～終了番号を何回入力するかを指定
　・スキップ数　　：　開始～終了番号を幾つ飛ばしで入力するかを指定
　・挿入番号　　　：　開始～終了番号と交互に入力する値の指定

・四則演算
　選択範囲のタイミングの値について、指定の値と四則演算を行います。

　例1）"+10"を入力。【1-2-3--X】のタイミングが【11-12-13--X】に変更される。

　例2）"*3"を入力。【1-2-3--X】のタイミングが【3-6-9--X】に変更される。

　入力は先頭１文字に四則演算の記号"+-*/"を、続けて数値を入力します。
　整数演算なので、割り算の場合は小数点以下は無効。１以下は全て"０"になります。
　"０"との掛け算、割り算は無視されます。

・FPS変更
　作業中のセルの既定フレームスピード（Frame Per Second）を変更します。
　※AEからペーストした場合、その時点で自動的にAE設定中のFPSが採用されます。
　　本ツールで作業し始めた場合に使用してください。

・オプション
	・TimeRemap以外で使う
	　チェックを付けると、通常ならAEへコピー時に行っている計算を行わない。
	　※下記の式を使わず、入力内容をそのまま出力する。
	　　『(Cel# - 開始フレーム) / fps 』

	・開始フレーム
	　AE側の『時間設定』で行う『開始フレーム番号』と同じような扱いです。
	　起動直後は"１"が設定されます。
	　※AEコピー／ペースト時に、この値が加減算されます。

・クリア
　作業内容を初期化します。

・カラセル指定
　空セル指定時の、セル番号を指定します。
　※デフォルトは"100"です。
　※(v2.0.0.6)オプションに、カーソル移動抑止設定を追加。

・切り貼り
　シートの先頭に切り貼りしたシートの場合に、切り貼りしたコマ数を設定します。
　切り貼り設定範囲で再度"切り貼り設定の操作"を行うと、その範囲の切り貼り設定を解除します。
　※(v2.0.0.6)複数切り貼りに対応。

・中抜き
　シートの途中を中抜きしたシートの場合に、中抜きした範囲を設定します。
　中抜き設定範囲で再度"中抜き設定の操作"を行うと、その範囲の中抜き設定を解除します。
　※(v2.0.0.6)複数中抜きに対応。

・セル枚数指定
　セルの重ね枚数を指定します。
　※『A～E』セルの場合は"5"を指定します。
　※26枚までは、デフォルトでA～Zのセル名称を設定します。
　※(v2.0.0.6)セル枚数を26枚以上指定した場合のアラートを追加。
　※(v2.0.0.8)アラートの条件を、最大セル枚数を超えた場合に変更。

・セルの入れ替え
　セルのタイトルをドラッグすることで、別の場所に差し替えます。
　※(v2.0.0.6)新規追加。

・セルの挿入(削除)
　右クリックメニュの"セル枚数"～"セルの挿入(セルの削除)"にて、選択位置に選択範囲分のセルを追加(削除)します。
　※(v2.0.0.7)挿入動作を追加。
　※(v2.0.0.9)削除動作を追加。


◇起動時の引数について

　STS形式のファイルパスを渡すことで、起動時にSTS形式ファイルの読み込みを行います。

　推奨はしていませんが、AEIOUは複数起動可能なので複数のSTS形式のファイルを開くことが出来ます。
　※AEIOU間でのコピー＆ペーストはできません。但し、AfterEffectsへのコピー＆ペースト機能での受け渡しは可能です。
　※設定ファイルは共通なので、最後に閉じたAEIOUの設定が残ります。


◇キーバインドについて
　aeiou.iniの <shortcuts>及び <binds>タグの中に並ぶタグに書かれた内容の変更や項目の追加により、ショートカットキー及びシート編集のキーバインドを変更できます。

　▽ショートカットの変更
　　<shortcuts>タグ内に並ぶ機能名称のタグに挟まれた内容を編集することで、ショートカットキーを変更できます。
　　例えば、AEへコピーのショートカットを『Ctrl+A』に変更する場合　以下のようにします。
　　　変更前： <remapToAE>O, Control</remapToAE>
　　　変更後： <remapToAE>A, Control</remapToAE>


    アンドゥ			：<undo>
    AEへコピー			：<remapToAE>
    AEへコピー(TimeRemap以外)	：<remapToAE2>
    AEへコピー(Script仲介)	：<remapToAE3>
    AEからペースト		：<remapFromAE>
    中抜きフレームに設定	：<komanuki>
    中抜き設定の解除		：<komanukiCancel>
    切り貼りフレームに設定	：<harikomi>
    切り貼り設定の解除		：<harikomiCancel>
    コピー			：<copy>
    切り取り			：<cut>
    貼り付け			：<paste>
    FPS変更⇒30			：<set30fps>
    FPS変更⇒24			：<set24fps>
    セル枚数の指定...		：<inputCellCount>
    開始フレーム...		：<firstFrame>
    カラセル文字列...		：<karaCell><value>
    カラセル入力時の移動抑止	：<karaCell><noMove>
    シートの秒数...		：<sheetSec>
    24fps時の基準線指定⇒4	：<setSheetDiv4>
    24fps時の基準線指定⇒6	：<setSheetDiv6>
    24fps時の基準線指定⇒12	：<setSheetDiv12>
    常に一番上に表示		：<stayOnTop>
    セル変更時にウィンドウ位置調整する	：<autoAdjust>
    フレーム数表示に		：<displayFrameNumber>
    AfterFX.exe パス設定	：<afterFX><path>
    リマップ用jsx パス設定	：<afterFX><option>
    リマップデータのバージョン	：<afterFX><remapVersion>
    クリア			：<allInitialize>


　▽キーバインドの変更
　　※未定


◇起動スイッチについて
　(v3.0.0.0)廃止。


◇"ShortCuts.ini"ファイルについて
　(v3.0.0.0)廃止。aeiou.iniに統一。


◇"KeyCodes.ini"ファイルについて
　(v3.0.0.0)廃止。aeiou.iniに統一。


・STS形式書き出し時の注意点（１）
　STSでは、編集するカットの尺を設定するので、セルの終了位置が自動的に決まってくるが、AEIOUにはそれがない。
　その為、AEIOUでSTS形式を扱う場合は、終端位置に"0"を入れておく必要がある。
　入れなかった場合、起動中のAEIOUの最大編集長でのデータ生成が行われる。（デフォルトでは、シート13枚半分）
　但し、この情報をAEにコピーした場合、意図しないリマップ情報になる為、STS形式書き出しの利用をする場合にしか使わないように気をつけること。

・STS形式書き出し時の注意点（２）
　AEIOU上の半透明のウィンドウ『話数、カット』に、番号を入れておくと、STS書き出し時のファイル名に反映される。
　ファイル名に使えない文字は使用しないこと。

・AEへコピー時の Keyframe Data のバージョン文字列について
　AEIOUを終了すると .iniファイルが作成されるので、メモ帳で .iniファイルを開き <remapVersion> タグを検索してください。
　デフォルトでは「9.0」を設定しています。
　使用しているAfter Effectsに応じたバージョン文字列に変更して、.iniファイルを保存してください。

・Keyframe Data のバージョン文字列の確認方法
　編集の保存後にAEIOUを起動して「AEへコピー」の操作を行います。
　メモ帳を開き、ペースト操作（Ctrl+V）を行ってください。
　バージョン文字列（Keyframe Data）が、指定の数値に変更されていることを確認してください。



　以下、免責事項など書き添えます。
　先日同系統のツール開発者さんに書いておいた方がいいよ、と言われましたもので。
　個人的にはあまり気にしておりませんでしたが、いろんな方がいらっしゃるのかな、と…。
　そもそもこういった面倒な但し書きを書きたくない..というのがありますので、各々でご理解ご配慮いただければ幸いです。

◇当ツールの運用規約・免責等について

　・当ツール制作者（以下甲と称す）と
　　当ツールのご利用者（以下乙と称す）は、
　　当ツール（以下丙と称す）の利用について、
　　ここに定める運用規約に同意するものとします。

　・丙はAdobe AfterEffectsによるアニメーション撮影作業（シート打ち込み）手順軽減目的のソフトです。
　　丙の制作・配布は営利目的ではありません。ただ乙の作業ストレスを解消することが目的です。
　　個人法人を問わずいかなる場合も丙は無償提供されるものとします。
　　丙の利用に関して金銭の取引を行わないでください。
　　丙自体を付加価値とした取引を行わないでください。
　・丙の利用により乙の作業ストレスが解消できない場合、可能な限り利用を停止し別途解消方法を検討してください。
　・丙のご利用は乙の責任において行ってください。
　　甲は丙の利用により生じる乙の損害に対する責任を負いません。
　　※バグによる作業データ消失の可能性があります。
　　※ウィルスチェックは行っていますが、100%ウィルス感染がないことを保証出来ません。実行前に必ずご自身でウィルスチェックを行って下さい。
　　※環境移行で使えなくなる可能性があります。
　　※事前の動作確認・代替物調査など確認の上で計画的にご利用下さい。
　・丙の著作権は甲に帰属するものとします。
　・乙は上記について承諾の上で丙の利用を許可されるものとします。
　・上記について承諾の上での丙の配布はご自由に願います。
　　※配布の際は、配布先に対しても上記について承諾の確認をお願いします。

◇バグ・要望について
　・バグ・要望については可能な限りステップバイステップでの手順説明、使用ＯＳなど実行環境についてレポート願います。
　　レポート戴けない場合・当方で問題再現不可能な場合には対応できない場合も御座いますのでご理解ご協力をお願いします。
　・バグ・要望には当方の可能な範囲で応えます。
　　※必ず応えるとのお約束は出来ません。
　　※環境がなく再現や動作確認不能な場合などで対応出来ない場合もあります。
　・ご要望の機能追加について後々著作権を主張されても応じられません。
　　主張される方は要望を出さないで下さい。
　・上記についてご承諾戴いた上でご連絡下さい。

◇ご要望の受付可能な範囲について
　・連絡先を特に明記しておりません。
　・対応は、まずは間接的にでも当方にコンタクトできる方のみに限定させていただこうと考えております。
　・それなりに責任を持って対応するには限度がある為です。ご理解の程よろしくお願い致します。



[End Of File]